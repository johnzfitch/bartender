// Bartender - Clean utilitarian bar
@use "sass:string";

// GTK alpha function wrapper
@function gtkalpha($c, $a) {
  @return string.unquote("alpha(#{$c},#{$a})");
}

$background: #1a1b26;
$foreground: #c0caf5;
$dim: rgba($foreground, 0.35);
$accent: #7aa2f7;
$green: #9ece6a;
$yellow: #e0af68;
$red: #f7768e;

window.bartender {
  background: transparent;
  font-family: "IBM Plex Sans", "SF Pro Display", "Fira Sans", "Berkeley Mono", sans-serif;
  font-size: 14px;
  color: $foreground;
  // Shadow casts onto desktop below the bar
  box-shadow: 0 6px 20px 4px rgba(0, 0, 0, 0.5);

  > box {
    background: gtkalpha($background, 0.85);
    padding: 0 8px;
    // Inner shadow for depth
    box-shadow: inset 0 -1px 2px rgba(0, 0, 0, 0.3);
  }

  // Strip ALL button chrome
  button,
  menubutton > button {
    all: unset;
    padding: 8px 10px;
    transition: color 100ms ease;
  }

  menubutton {
    all: unset;
  }

  // Popover keeps some structure
  popover {
    background: $background;
    color: $foreground;
    border: 1px solid rgba($foreground, 0.15);
    border-radius: 6px;
    padding: 8px;
  }

  // Workspaces - always 1-5, visual states like waybar
  .workspaces {
    .ws {
      padding: 8px 10px;
      font-size: 14px;
      font-weight: normal;
      color: rgba($foreground, 0.4); // empty - more visible

      &.occupied {
        color: rgba($foreground, 0.75);
      }

      &.focused {
        color: $foreground;
        font-weight: bold;
      }

      &:hover {
        color: $accent;
      }
    }
  }

  // Clock - consistent spacing
  .clock {
    > button {
      padding: 8px 10px;
      color: $foreground;

      &:hover {
        color: $accent;
      }
    }
  }

  // Feed ticker
  .feed-ticker {
    padding: 8px 16px;
    font-size: 14px;
    font-weight: bold;
    color: $foreground;

    &.loading {
      color: $dim;
    }

    &.error {
      color: $red;
    }

    label {
      font-weight: normal;
    }

    &:hover label {
      color: $accent;
    }
  }

  // System tray - consistent spacing with other icons
  .tray {
    menubutton > button {
      &:hover image {
        opacity: 0.8;
      }
    }

    image {
      min-width: 18px;
      min-height: 18px;
    }
  }

  // Volume - consistent spacing
  .volume {
    > button {
      padding: 8px 10px;
      color: $foreground;

      &:hover {
        color: $accent;
      }

      image {
        min-width: 18px;
        min-height: 18px;
      }
    }

    slider {
      min-height: 6px;
      margin: 8px;

      trough {
        background: rgba($foreground, 0.15);
        border-radius: 3px;
        min-height: 6px;
      }

      highlight {
        background: $accent;
        border-radius: 3px;
      }

      slider {
        background: $foreground;
        border-radius: 50%;
        min-width: 12px;
        min-height: 12px;
        margin: -3px;
      }
    }
  }

  // Status widgets - consistent spacing and colors
  .vpn, .proxyforge, .audio {
    padding: 8px 10px;
  }

  .vpn {
    &.connected { color: $green; }
    &.connecting { color: $yellow; }
    &.disconnected { color: $dim; }
  }

  .proxyforge {
    &.proxyforge-active { color: $green; }
    &.proxyforge-starting,
    &.proxyforge-stopping { color: $yellow; }
    &.proxyforge-off { color: $dim; }
  }

  .audio {
    &.speakers { color: $foreground; }
    &.headphones { color: $foreground; }
    &.both { color: $green; }
    &.muted { color: $red; }
  }

  // All images/icons inherit color
  image {
    -gtk-icon-style: symbolic;
  }
}
